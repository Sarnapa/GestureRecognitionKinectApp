<Page x:Class="GestureRecognition.Applications.GestureRecognitionKinectApp.Views.SettingsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:GestureRecognition.Applications.GestureRecognitionKinectApp.Views"
      mc:Ignorable="d" 
      d:DesignHeight="864" d:DesignWidth="1152"
      Title="SettingsPage">

    <Page.Resources>
        <Style TargetType="{x:Type Label}" x:Key="SettingsLabel" BasedOn="{StaticResource {x:Type Label}}">
            <Setter Property="HorizontalAlignment" Value="Stretch" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="HorizontalContentAlignment" Value="Center" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="FontSize" Value="24" />
        </Style>
        <Style TargetType="{x:Type Label}" x:Key="SettingsOptionLabel" BasedOn="{StaticResource {x:Type Label}}">
            <Setter Property="HorizontalAlignment" Value="Stretch" />
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Margin" Value="0,0,5,0" />
        </Style>
        <Style TargetType="{x:Type Slider}" x:Key="DecimalRangeSliderStyle">
            <Setter Property="Orientation" Value="Horizontal"/>
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Minimum" Value="0.0"/>
            <Setter Property="Maximum" Value="1.0"/>
            <Setter Property="SmallChange" Value="0.05"/>
            <Setter Property="LargeChange" Value="0.1"/>
            <Setter Property="TickFrequency" Value="0.05"/>
            <Setter Property="TickPlacement" Value="BottomRight"/>
            <Setter Property="IsSnapToTickEnabled" Value="True"/>
            <Setter Property="AutoToolTipPlacement" Value="BottomRight"/>
            <Setter Property="AutoToolTipPrecision" Value="2"/>
        </Style>
        <Style TargetType="{x:Type Slider}" x:Key="IntegerRangeSliderStyle">
            <Setter Property="Orientation" Value="Horizontal"/>
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Minimum" Value="0"/>
            <Setter Property="Maximum" Value="2"/>
            <Setter Property="SmallChange" Value="1"/>
            <Setter Property="LargeChange" Value="1"/>
            <Setter Property="TickFrequency" Value="1"/>
            <Setter Property="TickPlacement" Value="BottomRight"/>
            <Setter Property="IsSnapToTickEnabled" Value="True"/>
            <Setter Property="AutoToolTipPlacement" Value="BottomRight"/>
            <Setter Property="AutoToolTipPrecision" Value="0"/>
        </Style>
        <Style x:Key="{x:Type ToolBar}" TargetType="ToolBar">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="ToolBarTray.IsLocked" Value="True"/>
        </Style>
    </Page.Resources>

    <Page.DataContext>
        <Binding Source="{StaticResource Locator}" Path="Settings"/>
    </Page.DataContext>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="3*" />
            <RowDefinition Height="11*" />
            <RowDefinition Height="11*" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <ToolBar HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Loaded="ToolBar_Loaded">
            <Button ToolTip="{Binding ReturnButtonTip}" Command="{Binding ReturnCommand}">
                <Image Source="{Binding ReturnButtonImageUri}"/>
            </Button>
        </ToolBar>

        <Border Grid.Row="1" Grid.RowSpan="2" BorderBrush="DarkGray" BorderThickness="1" Margin="1,1,1,1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <Label Style="{StaticResource SettingsLabel}" Content="General settings"/>

                <DockPanel Grid.Row="1" Margin="10,0,100,0">
                    <Label Style="{StaticResource SettingsOptionLabel}" Content="Tracking mode:"/>
                    <ComboBox HorizontalAlignment="Left" VerticalAlignment="Center"
                              HorizontalContentAlignment="Left" VerticalContentAlignment="Center"
                              ItemsSource="{Binding TrackingModes}"
                              SelectedItem="{Binding TrackingMode}"/>
                </DockPanel>
                
                <DockPanel Grid.Row="2" Margin="10,0,100,0">
                    <Label Style="{StaticResource SettingsOptionLabel}" Content="Tracked joint's score threshold:" />
                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Center">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="4*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Slider Name="trackedJointScoreThresholdSlider" Style="{StaticResource DecimalRangeSliderStyle}" Value="{Binding TrackedJointScoreThreshold}" />
                        <TextBox Grid.Column="1" Text="{Binding ElementName=trackedJointScoreThresholdSlider, Path=Value, UpdateSourceTrigger=PropertyChanged, StringFormat='{}{0:F2}'}" Margin="5,0,0,0" IsEnabled="False"/>
                    </Grid>
                </DockPanel>

                <DockPanel Grid.Row="3" Margin="10,0,100,0">
                    <Label Style="{StaticResource SettingsOptionLabel}" Content="Inferred joint's score threshold:" />
                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Center">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="4*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Slider Name="inferredJointScoreThresholdSlider" Style="{StaticResource DecimalRangeSliderStyle}" Value="{Binding InferredJointScoreThreshold}" />
                        <TextBox Grid.Column="1" Text="{Binding ElementName=inferredJointScoreThresholdSlider, Path=Value, UpdateSourceTrigger=PropertyChanged, StringFormat='{}{0:F2}'}" Margin="5,0,0,0" IsEnabled="False"/>
                    </Grid>
                </DockPanel>

                <DockPanel Grid.Row="4" Margin="10,0,100,0">
                    <Label Style="{StaticResource SettingsOptionLabel}" Content="Allow body tracking lost&#x0a;for recording and recognizing&#x0a;using MediaPipe models:" />
                    <CheckBox HorizontalAlignment="Stretch" VerticalAlignment="Center" IsChecked="{Binding Path=AllowBodyTrackingLostForRecordingAndRecognizingUsingMediaPipeModels, Mode=TwoWay}" />
                </DockPanel>

                <DockPanel Grid.Row="5" Margin="10,0,100,0" Visibility="{Binding Path=AdminModeSettingsVisibility}">
                    <Label Style="{StaticResource SettingsOptionLabel}" Content="Allow automatic gesture record export:" />
                    <CheckBox HorizontalAlignment="Stretch" VerticalAlignment="Center" IsChecked="{Binding Path=AllowAutomaticGestureRecordExport, Mode=TwoWay}" />
                </DockPanel>

                <DockPanel Grid.Row="6" Margin="10,0,100,0" Visibility="{Binding Path=AdminModeSettingsVisibility}">
                    <Label Style="{StaticResource SettingsOptionLabel}" Content="Default gesture label:" />
                    <ComboBox HorizontalAlignment="Left" VerticalAlignment="Center"
                              HorizontalContentAlignment="Left" VerticalContentAlignment="Center"
                              ItemsSource="{Binding GestureLabels}"
                              SelectedItem="{Binding DefaultGestureLabel}"/>
                </DockPanel>

                <DockPanel Grid.Row="7" Margin="10,0,100,0" Visibility="{Binding Path=AdminModeSettingsVisibility}">
                    <Label Style="{StaticResource SettingsOptionLabel}" Content="Current user:" />
                    <ComboBox HorizontalAlignment="Left" VerticalAlignment="Center"
                              HorizontalContentAlignment="Left" VerticalContentAlignment="Center"
                              ItemsSource="{Binding Users}"
                              SelectedItem="{Binding CurrentUser}"/>
                </DockPanel>

                <DockPanel Grid.Row="8" Margin="10,0,100,0" Visibility="{Binding Path=AdminModeSettingsVisibility}">
                    <Label Style="{StaticResource SettingsOptionLabel}" Content="Gestures dataset path:" />
                    <TextBox HorizontalAlignment="Left" VerticalAlignment="Center"
                             HorizontalContentAlignment="Left" VerticalContentAlignment="Center"
                             Text="{Binding GesturesDatasetPath}"/>
                </DockPanel>

                <DockPanel Grid.Row="9" Margin="10,0,100,0" Visibility="{Binding Path=AdminModeSettingsVisibility}">
                    <Label Style="{StaticResource SettingsOptionLabel}" Content="Gesture record file name extra label:" />
                    <TextBox HorizontalAlignment="Left" VerticalAlignment="Center"
                             HorizontalContentAlignment="Left" VerticalContentAlignment="Center"
                             Text="{Binding GestureRecordFileNameExtraLabel}"/>
                </DockPanel>
            </Grid>
        </Border>

        <Border Grid.Row="1" Grid.Column="1" BorderBrush="DarkGray" BorderThickness="1" Margin="1,1,1,1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <Label Style="{StaticResource SettingsLabel}" Content="MediaPipe pose landmarks model settings"/>

                <DockPanel Grid.Row="1" Margin="10,0,100,0">
                    <Label Style="{StaticResource SettingsOptionLabel}" Content="Minimum pose detection confidence:" />
                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Center">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="4*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Slider Name="minPoseDetectionConfidenceSlider" Style="{StaticResource DecimalRangeSliderStyle}" Value="{Binding MinPoseDetectionConfidence}" />
                        <TextBox Grid.Column="1" Text="{Binding ElementName=minPoseDetectionConfidenceSlider, Path=Value, UpdateSourceTrigger=PropertyChanged, StringFormat='{}{0:F2}'}" Margin="5,0,0,0" IsEnabled="False"/>
                    </Grid>
                </DockPanel>

                <DockPanel Grid.Row="2" Margin="10,0,100,0">
                    <Label Style="{StaticResource SettingsOptionLabel}" Content="Minimum pose presence confidence:" />
                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Center">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="4*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Slider Name="minPosePresenceConfidenceSlider" Style="{StaticResource DecimalRangeSliderStyle}" Value="{Binding MinPosePresenceConfidence}" />
                        <TextBox Grid.Column="1" Text="{Binding ElementName=minPosePresenceConfidenceSlider, Path=Value, UpdateSourceTrigger=PropertyChanged, StringFormat='{}{0:F2}'}" Margin="5,0,0,0" IsEnabled="False"/>
                    </Grid>
                </DockPanel>

                <DockPanel Grid.Row="3" Margin="10,0,100,0">
                    <Label Style="{StaticResource SettingsOptionLabel}" Content="Minimum tracking confidence:" />
                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Center">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="4*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Slider Name="poseLandmarksMinTrackingConfidenceSlider" Style="{StaticResource DecimalRangeSliderStyle}" Value="{Binding PoseLandmarksMinTrackingConfidence}" />
                        <TextBox Grid.Column="1" Text="{Binding ElementName=poseLandmarksMinTrackingConfidenceSlider, Path=Value, UpdateSourceTrigger=PropertyChanged, StringFormat='{}{0:F2}'}" Margin="5,0,0,0" IsEnabled="False"/>
                    </Grid>
                </DockPanel>
            </Grid>
        </Border>

        <Border Grid.Row="2" Grid.Column="1" BorderBrush="DarkGray" BorderThickness="1" Margin="1,1,1,1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <Label Style="{StaticResource SettingsLabel}" Content="MediaPipe hand landmarks model settings"/>

                <DockPanel Grid.Row="1" Margin="10,0,100,0">
                    <Label Style="{StaticResource SettingsOptionLabel}" Content="Hands to be tracked number:" />
                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Center">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="4*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Slider Name="numHandsSlider" Style="{StaticResource IntegerRangeSliderStyle}" Value="{Binding NumHands}" />
                        <TextBox Grid.Column="1" Text="{Binding ElementName=numHandsSlider, Path=Value, UpdateSourceTrigger=PropertyChanged}" Margin="5,0,0,0" IsEnabled="False"/>
                    </Grid>
                </DockPanel>

                <DockPanel Grid.Row="2" Margin="10,0,100,0">
                    <Label Style="{StaticResource SettingsOptionLabel}" Content="Minimum hand detection confidence:" />
                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Center">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="4*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Slider Name="minHandDetectionConfidenceSlider" Style="{StaticResource DecimalRangeSliderStyle}" Value="{Binding MinHandDetectionConfidence}" />
                        <TextBox Grid.Column="1" Text="{Binding ElementName=minHandDetectionConfidenceSlider, Path=Value, UpdateSourceTrigger=PropertyChanged, StringFormat='{}{0:F2}'}" Margin="5,0,0,0" IsEnabled="False"/>
                    </Grid>
                </DockPanel>

                <DockPanel Grid.Row="3" Margin="10,0,100,0">
                    <Label Style="{StaticResource SettingsOptionLabel}" Content="Minimum hand presence confidence:" />
                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Center">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="4*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Slider Name="minHandPresenceConfidenceSlider" Style="{StaticResource DecimalRangeSliderStyle}" Value="{Binding MinHandPresenceConfidence}" />
                        <TextBox Grid.Column="1" Text="{Binding ElementName=minHandPresenceConfidenceSlider, Path=Value, UpdateSourceTrigger=PropertyChanged, StringFormat='{}{0:F2}'}" Margin="5,0,0,0" IsEnabled="False"/>
                    </Grid>
                </DockPanel>

                <DockPanel Grid.Row="4" Margin="10,0,100,0">
                    <Label Style="{StaticResource SettingsOptionLabel}" Content="Minimum tracking confidence:" />
                    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Center">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="4*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Slider Name="handLandmarksMinTrackingConfidenceSlider" Style="{StaticResource DecimalRangeSliderStyle}" Value="{Binding HandLandmarksMinTrackingConfidence}" />
                        <TextBox Grid.Column="1" Text="{Binding ElementName=handLandmarksMinTrackingConfidenceSlider, Path=Value, UpdateSourceTrigger=PropertyChanged, StringFormat='{}{0:F2}'}" Margin="5,0,0,0" IsEnabled="False"/>
                    </Grid>
                </DockPanel>
            </Grid>
        </Border>
    </Grid>
</Page>
